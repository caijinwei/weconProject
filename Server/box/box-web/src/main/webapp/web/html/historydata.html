<!DOCTYPE html>
<html lang="en" ng-app="weconweb">
<head>
<meta charset="UTF-8">
<title>Title</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="../css/style.css" />
<link rel="stylesheet"
	href="../lib/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet"
	href="../lib/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet"
	href="../lib/bootstrap/datetimepicker/css/bootstrap-datetimepicker.min.css">
<link rel="stylesheet"
	href="../lib/bootstrap/select/css/bootstrap-select.css">

</head>
<body ng-controller="infoController" ng-init="onInit()"
	style="margin-top: 20px;">
	<ol class="breadcrumb">
		<li><a href="overview.html">主页</a></li>
		<li class="active">{{devicename}}</li>
	</ol>
	<ul class="nav nav-pills nav-justified" role="tablist">
		<li><a
			href="datamonitor.html?device_id={{deviceid}}&&device_name={{devicename}}">数据监控</a></li>
		<li><a
			href="alarmlog.html?device_id={{deviceid}}&&device_name={{devicename}}">报警记录</a></li>
		<li class="active"><a
			href="historydata.html?device_id={{deviceid}}&&device_name={{devicename}}">历史数据</a></li>
		<li ng-cloak ng-if="accounttype==1 && deviceid>0"><a
			href="remotedownload.html?device_id={{deviceid}}&&device_name={{devicename}}">远程下载</a></li>
		<li ng-cloak ng-if="accounttype==1 && deviceid>0"><a
			href="baseinfo.html?device_id={{deviceid}}&&device_name={{devicename}}">基本配置</a></li>
	</ul>
	<div class="container-fluid" style="margin-top: 40px;">
		<ul class="nav nav-tabs" role="tablist" id="historyDataTab">
			<li class="active"><a href="#original-data" data-toggle="tab">原始数据</a></li>
			<li><a href="#statistic-analysis" data-toggle="tab">统计分析</a></li>
			<li><a href="#data-record" data-toggle="tab">数据登记</a></li>
			<li><a href="#history-global-setting" data-toggle="tab">全局设置</a></li>

		</ul>
		<div class="tab-content">
			<!--原始数据-->
			<div class="tab-pane active" id="original-data">
				<div class="container-fluid" style="margin-top: 20px;">
					<div class="row">
						<div>
							<span class="col-md-1" style="height: 30px; line-height: 30px;">监控点</span>
							<select id="monitorid" class="col-md-3" style="height: 35px;">
								<option ng-repeat="x in commonitors" value={{x.id}}>{{x.name}}</option>
							</select>
						</div>
						<div class="btn-group" style="margin-left: 20px;">
							<button id="btn-list" type="button" class="btn btn-default"
								onclick="showListView()">列表</button>
							<button id="btn-curves" type="button" class="btn btn-primary"
								onclick="showCurvesView()">曲线</button>
						</div>
					</div>
					<div class="row" style="margin-top: 20px;">
						<div style="display: inline-block; margin-left: -15px;"
							class="col-md-4">
							<span class="col-md-3" style="height: 30px; line-height: 30px;">起始日期</span>
							<div class="input-group date form_datetime col-md-9"
								data-date="1979-09-16T05:25:07Z"
								data-date-format="yyyy-mm-dd hh:ii" data-link-field="dtp_input1">
								<input id="startdateid" class="form-control" size="16"
									type="text" value="" readonly> <span
									class="input-group-addon"><span
									class="glyphicon glyphicon-remove"></span></span> <span
									class="input-group-addon"><span
									class="glyphicon glyphicon-th"></span></span>
							</div>
						</div>
						<div
							style="float: left; display: inline-block; margin-left: 35px;"
							class="col-md-4">
							<span class="col-md-3" style="height: 30px; line-height: 30px;">结束日期</span>
							<div class="input-group date form_datetime col-md-9"
								data-date="1979-09-16T05:25:07Z"
								data-date-format="yyyy-mm-dd hh:ii" data-link-field="dtp_input1">
								<input id="enddateid" class="form-control" size="16" type="text"
									value="" readonly> <span class="input-group-addon"><span
									class="glyphicon glyphicon-remove"></span></span> <span
									class="input-group-addon"><span
									class="glyphicon glyphicon-th"></span></span>
							</div>
						</div>
						<button type="button" class="btn btn-primary" id="searchid"
							style="margin-left: 30px;"
							ng-click="searchHisData(paginationConf.currentPage,paginationConf.itemsPerPage)">
							<span class="glyphicon glyphicon-search"></span>
						</button>
						<button type="button" class="btn btn-primary" disabled>
							<span class="glyphicon glyphicon-share"></span>
						</button>
						<button type="button" class="btn btn-primary" disabled>
							<span class="glyphicon glyphicon-new-window"></span>
						</button>
					</div>
					<div id="list-view" style="display: none;">
						<table class="table table-bordered" style="margin-top: 20px;">
							<thead>
								<tr>
									<th class="col-md-4">时间</th>
									<th class="col-md-8">数值</th>

								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="x in Hisdatas">

									<td>{{x.monitor_time|date:'yyyy-MM-dd HH:mm:ss'}}</td>
									<td>{{x.value}}</td>


								</tr>

							</tbody>

						</table>
						<tm-pagination conf="paginationConf"></tm-pagination>
					</div>
					<div id="curves-view">
						<div id="original-graph-container"
							style="min-width: 400px; height: 400px; margin-top: 40px;"></div>
					</div>
				</div>
			</div>
			<!--统计分析-->
			<div class="tab-pane" id="statistic-analysis">
				<div class="container-fluid" style="margin-top: 20px;">
					<div class="row">
						<span class="col-md-1" style="height: 30px; line-height: 30px;">监控点</span>
						<select class="col-md-3" style="height: 35px;">
							<option>请选择监控点</option>
							<option>监控点1</option>
							<option>监控点2</option>
							<option>监控点3</option>
						</select> <span class="col-md-1"
							style="height: 30px; line-height: 30px; margin-left: 30px">通道</span>
						<select class="col-md-3" style="height: 35px;">
							<option>请选择通道</option>
							<option>通道1</option>
							<option>通道2</option>
							<option>通道3</option>
						</select>
						<div class="btn-group" style="margin-left: 20px;">
							<button type="button" class="btn btn-primary">分</button>
							<button type="button" class="btn btn-default">时</button>
							<button type="button" class="btn btn-default">天</button>
						</div>
					</div>
					<div class="row" style="margin-top: 20px;">
						<div style="display: inline-block; margin-left: -15px;"
							class="col-md-4">
							<span class="col-md-3" style="height: 30px; line-height: 30px;">起始日期</span>
							<div class="input-group date form_datetime col-md-9"
								data-date="1979-09-16T05:25:07Z"
								data-date-format="yyyy-mm-dd hh:ii">
								<input class="form-control" size="16" type="text" value=""
									readonly> <span class="input-group-addon"><span
									class="glyphicon glyphicon-remove"></span></span> <span
									class="input-group-addon"><span
									class="glyphicon glyphicon-calendar"></span></span>
							</div>
						</div>
						<div
							style="float: left; display: inline-block; margin-left: 35px;"
							class="col-md-4">
							<span class="col-md-3" style="height: 30px; line-height: 30px;">结束日期</span>
							<div class="input-group date form_datetime col-md-9"
								data-date="1979-09-16T05:25:07Z"
								data-date-format="yyyy-mm-dd hh:ii">
								<input class="form-control" size="16" type="text" value=""
									readonly> <span class="input-group-addon"><span
									class="glyphicon glyphicon-remove"></span></span> <span
									class="input-group-addon"><span
									class="glyphicon glyphicon-calendar"></span></span>
							</div>
						</div>
						<button type="button" class="btn btn-primary"
							style="margin-left: 30px;" disabled>
							<span class="glyphicon glyphicon-search"></span>
						</button>
					</div>
					<div class="row" style="margin-top: 20px;">
						<div class="btn-group" style="margin-left: 20px; float: right;">
							<button type="button" class="btn btn-primary">曲线图</button>
							<button type="button" class="btn btn-default">K线图</button>
						</div>
					</div>
					<div id="statistic-graph-container"
						style="min-width: 400px; height: 400px; margin-top: 40px;"></div>
				</div>
			</div>
			<!--数据登记-->
			<div class="tab-pane" id="data-record">
				<div class="container-fluid" style="margin-top: 20px;">
					<table class="table table-bordered">
						<caption>
							<button type="button" class="btn btn-primary" data-toggle="modal"
								data-target="#dataRecord">
								<span class="glyphicon glyphicon-pencil"></span> 数据登记
							</button>
						</caption>
						<thead>
							<tr>
								<th>名称</th>
								<th>周期(秒)</th>
								<th>通道</th>
								<th>连接设备</th>
								<th>数据类型</th>
								<th>地址类型</th>
								<th>操作</th>
							</tr>
						</thead>
						<tbody>

						</tbody>
					</table>
				</div>
			</div>
			<!--全局设置-->
			<div class="tab-pane" id="history-global-setting">
				<div class="container-fluid" style="margin-top: 20px;">
					<div class="checkbox">
						<label> <input type="checkbox" value="" />暂停历史数目推送
						</label>
					</div>
				</div>
			</div>
		</div>
		<!--数据登记Modal-->
		<div class="modal" id="dataRecord" tabindex="-1" data-backdrop="false">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">
							<span>&times;</span>
						</button>
						<h4 class="modal-title">数据登记</h4>
					</div>
					<div class="modal-body">
						<div class="container-fluid">
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<span class="col-md-3">名称</span><input type="text"
									class="col-md-9" style="height: 30px; padding-left: 5px;" />
							</div>
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<span class="col-md-3">连接设备</span> <select class="col-md-9"
									style="height: 30px;">
									<option>SIMUTOCOL LX1S</option>
									<option>SIMUTOCOL LX2N</option>
									<option>SIMUTOCOL LX3V</option>
								</select>
							</div>
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<span class="col-md-3">数据格式</span> <select id="datatype"
									class="col-md-9" style="height: 30px;"
									onchange="show_sub(this.options[this.options.selectedIndex].value)">
									<option value="0">0：位地址</option>
									<option value="162">16位二进制</option>
									<option value="168">16位八进制</option>
									<option value="1616">16位十六进制</option>
									<option value="16bcd">16位BCD码</option>
									<option value="16110">16位有符号十进制数</option>
									<option value="16010">16位无符号十进制数</option>
									<option value="322">32位二进制</option>
									<option value="328">32位八进制</option>
									<option value="3216">32位十六进制</option>
									<option value="32bcd">32位BCD码</option>
									<option value="32110">32位有符号十进制数</option>
									<option value="32010">32位无符号十进制数</option>
									<option value="32f">32位（单精度）浮点数</option>
									<option value="64d">64位（双精度）浮点数</option>
								</select>
							</div>
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<span class="col-md-3">地址</span><input type="text"
									class="col-md-6" style="height: 30px; padding-left: 5px;" />
								<button type="button"
									class="btn btn-info col-md-2 col-md-offset-1"
									data-toggle="modal" data-target="#addrsetting">设置</button>
							</div>

							<div id="datadigits" class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0; display: none;">
								<div id="div-integer">
									<span class="col-md-3">整数位数</span> <select id="integerdigits"
										class="col-md-3" style="height: 30px;" onchange="getData()">

									</select>
								</div>
								<div id="div-decimal">
									<span class="col-md-3">小数位数</span> <select id="decimaldigits"
										class="col-md-3" style="height: 30px;"
										onchange="calcuSystem()">

									</select>
								</div>
							</div>
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<div id="value-min">
									<span class="col-md-3">最小值</span> <input id="dataMin"
										type="number" class="col-md-3"
										style="height: 30px; padding-left: 5px;" value="0" min="" />
								</div>
								<div id="value-max">
									<span class="col-md-3">最大值</span> <input id="dataMax"
										type="number" class="col-md-3"
										style="height: 30px; padding-left: 5px;" value="1" />
								</div>
							</div>
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<span class="col-md-3">历史数据采集周期（天）</span> <input type="text"
									class="col-md-9" style="height: 30px; padding-left: 5px;"
									value="2" />
							</div>
							<div class="row col-md-11 col-md-offset-1"
								style="margin: 10px 0;">
								<span class="col-md-3">描述</span> <input type="text"
									class="col-md-9" style="height: 30px; padding-left: 5px;"
									placeholder="0X 1" />
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-info">确定</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
					</div>
				</div>

			</div>
		</div>
	</div>

	<script src="../lib/hightcharts/highcharts.js"></script>
	<script src="../lib/hightcharts/exporting.js"></script>
	<script>
		/**
		 * Highcharts 在 4.2.0 开始已经不依赖 jQuery 了，直接用其构造函数既可创建图表
		 * 地址：https://www.hcharts.cn/docs/start-download
		 **/
		var chart = new Highcharts.Chart('original-graph-container', {
			title : {
				text : '年平均数值',
				x : -20
			},
			subtitle : {
				text : '数据来源: we-con.com.cn',
				x : -20
			},
			xAxis : {
				categories : [ '一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月',
						'九月', '十月', '十一月', '十二月' ]
			},
			yAxis : {
				title : {
					text : '值'
				},
				plotLines : [ {
					value : 0,
					width : 1,
					color : '#808080'
				} ]
			},
			tooltip : {
				valueSuffix : ''
			},
			legend : {
				layout : 'vertical',
				align : 'right',
				verticalAlign : 'middle',
				borderWidth : 0
			},
			series : [ {
				name : '监控点1',
				data : [ 7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3,
						18.3, 13.9, 9.6 ]
			} ]
		});
	</script>
	<script>
		var chart = new Highcharts.Chart('statistic-graph-container', {
			title : {
				text : '年平均数值',
				x : -20
			},
			subtitle : {
				text : '数据来源: we-con.com.cn',
				x : -20
			},
			xAxis : {
				categories : [ '一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月',
						'九月', '十月', '十一月', '十二月' ]
			},
			yAxis : {
				title : {
					text : '值'
				},
				plotLines : [ {
					value : 0,
					width : 1,
					color : '#808080'
				} ]
			},
			tooltip : {
				valueSuffix : ''
			},
			legend : {
				layout : 'vertical',
				align : 'right',
				verticalAlign : 'middle',
				borderWidth : 0
			},
			series : [ {
				name : '监控点1',
				data : [ 7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3,
						18.3, 13.9, 9.6 ]
			} ]
		});
	</script>
	<script>
		//        展示列表视图
		function showListView() {
			$('#btn-list').attr('class', 'btn btn-primary');
			$('#btn-curves').attr('class', 'btn btn-default');
			$('#list-view').css('display', 'block');
			$('#curves-view').css('display', 'none');
		}
		//        展示曲线视图
		function showCurvesView() {
			$('#btn-list').attr('class', 'btn btn-default');
			$('#btn-curves').attr('class', 'btn btn-primary');
			$('#list-view').css('display', 'none');
			$('#curves-view').css('display', 'block');
		}
	</script>

	<script src="../lib/jquery/jquery-3.2.1.min.js" type="text/javascript"></script>
	<script src="../lib/bootstrap/3.3.7/js/bootstrap.min.js"
		type="text/javascript"></script>
	<script src="../lib/angular/angular.min.js" type="text/javascript"></script>
	<script
		src="../lib/bootstrap/datetimepicker/js/bootstrap-datetimepicker.js"></script>

	<script src="../lib/wecon-common.js" type="text/javascript"></script>
	<script src="../js/historydata.js" type="text/javascript"></script>
	<script src="../lib/pagination.js" type="text/javascript"></script>

</body>
</html>